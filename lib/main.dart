import 'package:flutter/material.dart';
import 'package:just_audio/just_audio.dart';
import 'package:torch_light/torch_light.dart';
import 'package:vibration/vibration.dart';
import 'package:url_launcher/url_launcher.dart';
import 'dart:math';
import 'dart:async';

void main() {
  runApp(const MyApp());
}

class MyApp extends StatelessWidget {
  const MyApp({super.key});

  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'рднреВрдХрдореНрдк рдЬрд╛рдирдХрд╛рд░реА',
      theme: ThemeData(
        primarySwatch: Colors.blue,
        fontFamily: 'NotoSansDevanagari',
      ),
      home: const QuakeReadyApp(),
      debugShowCheckedModeBanner: false,
    );
  }
}

class QuakeReadyApp extends StatefulWidget {
  const QuakeReadyApp({super.key});

  @override
  _QuakeReadyAppState createState() => _QuakeReadyAppState();
}

class _QuakeReadyAppState extends State<QuakeReadyApp> {
  String _currentScreen = 'splash';
  int _selectedMenuIndex = 0;
  bool _isFlashlightOn = false;
  bool _isSirenPlaying = false;
  final AudioPlayer _audioPlayer = AudioPlayer();
  bool _isInfoAudioPlaying = false;
  bool _isDosDontsAudioPlaying = false;
  bool _isRetrofittingAudioPlaying = false;
  int _quizCurrentQuestionIndex = 0;
  int _quizCorrectAnswers = 0;
  List<int?> _quizUserAnswers = [];
  bool _quizShowResults = false;
  String? _quizFeedbackMessage;
  bool _quizIsFeedbackShowing = false;
  int _gameCurrentIndex = 0;
  List<bool> _gameSelectedItems = List.filled(11, false);
  int _gameCorrectCount = 0;
  bool _gameOver = false;

  // Splash Screen Logic
  @override
  void initState() {
    super.initState();
    Future.delayed(const Duration(seconds: 3), () {
      if (mounted) {
        setState(() {
          _currentScreen = 'home';
        });
      }
    });
    _quizQuestions.shuffle(Random());
    _quizSelectedQuestions = _quizQuestions.take(10).toList();
    for (var question in _quizSelectedQuestions) {
      List<String> options = List.from(question['options']);
      int correctIndex = question['correct'];
      String correctAnswer = options[correctIndex];
      options.shuffle(Random());
      question['options'] = options;
      question['correct'] = options.indexOf(correctAnswer);
    }
    _quizUserAnswers = List<int?>.filled(10, null);
    _gameItems.shuffle(Random());
  }

  // Audio Playback
  Future<void> _playAudio(String assetPath, {bool loop = false}) async {
    await _audioPlayer.stop();
    try {
      await _audioPlayer.setAsset(assetPath);
      if (loop) {
        await _audioPlayer.setLoopMode(LoopMode.all);
      } else {
        await _audioPlayer.setLoopMode(LoopMode.off);
      }
      await _audioPlayer.play();
      setState(() {
        if (assetPath == 'assets/siren.mp3') {
          _isSirenPlaying = true;
        } else if (assetPath == 'assets/audio/info_content.mp3') {
          _isInfoAudioPlaying = true;
        } else if (assetPath == 'assets/audio/dos_donts_content.mp3') {
          _isDosDontsAudioPlaying = true;
        } else if (assetPath == 'assets/audio/retrofitting_content.mp3') {
          _isRetrofittingAudioPlaying = true;
        }
      });
      _audioPlayer.playerStateStream.listen((state) {
        if (state.processingState == ProcessingState.completed && !loop) {
          setState(() {
            if (assetPath == 'assets/audio/info_content.mp3') {
              _isInfoAudioPlaying = false;
            } else if (assetPath == 'assets/audio/dos_donts_content.mp3') {
              _isDosDontsAudioPlaying = false;
            } else if (assetPath == 'assets/audio/retrofitting_content.mp3') {
              _isRetrofittingAudioPlaying = false;
            }
          });
        }
      });
    } catch (e) {
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(content: Text('рдЕрдбрд┐рдпреЛ рдкреНрд▓реЗ рдЧрд░реНрди рд╕рдХрд┐рдПрди: $e')),
      );
    }
    Vibration.vibrate(duration: 50);
  }

  Future<void> _stopAudio() async {
    await _audioPlayer.stop();
    setState(() {
      _isInfoAudioPlaying = false;
      _isDosDontsAudioPlaying = false;
      _isRetrofittingAudioPlaying = false;
      _isSirenPlaying = false;
    });
    Vibration.vibrate(duration: 50);
  }

  // Flashlight Toggle
  Future<void> _toggleFlashlight() async {
    try {
      if (_isFlashlightOn) {
        await TorchLight.disableTorch();
      } else {
        await TorchLight.enableTorch();
      }
      setState(() {
        _isFlashlightOn = !_isFlashlightOn;
      });
      Vibration.vibrate(duration: 50);
    } catch (e) {
      ScaffoldMessenger.of(context).showSnackBar(
        const SnackBar(
          content: Text('рдлреНрд▓реНрдпрд╛рд╢рд▓рд╛рдЗрдЯ рдЙрдкрд▓рдмреНрдз рдЫреИрдиред'),
          backgroundColor: Colors.red,
          duration: Duration(seconds: 2),
        ),
      );
    }
  }

  // Siren Toggle
  Future<void> _toggleSiren() async {
    try {
      if (_isSirenPlaying) {
        await _stopAudio();
      } else {
        await _playAudio('assets/siren.mp3', loop: true);
        ScaffoldMessenger.of(context).showSnackBar(
          const SnackBar(
            content: Text('рд╕рд╛рдпрд░рди рдЖрдкрддрдХрд╛рд▓реАрди рдЕрд╡рд╕реНрдерд╛рдорд╛ рдкреНрд░рдпреЛрдЧ рдЧрд░рд┐рдиреНрдЫ рдЬрдм рддрдкрд╛рдИрдВ рдмреЛрд▓реНрди рд╕рдХреНрдиреБрд╣реБрдиреНрди рд╡рд╛ рдлрд╕реНрдиреБрднрдПрдХреЛ рдЫред'),
            backgroundColor: Colors.orange,
            duration: Duration(seconds: 5),
          ),
        );
        ScaffoldMessenger.of(context).showSnackBar(
          const SnackBar(
            content: Text('рдХреГрдкрдпрд╛ рдбрд┐рднрд╛рдЗрд╕рдХреЛ рднреЛрд▓реНрдпреБрдо резрежреж% рдорд╛ рд╕реЗрдЯ рдЧрд░реНрдиреБрд╣реЛрд╕реНред'),
            backgroundColor: Colors.orange,
            duration: Duration(seconds: 3),
          ),
        );
      }
    } catch (e) {
      ScaffoldMessenger.of(context).showSnackBar(
        const SnackBar(
          content: Text('рд╕рд╛рдпрд░рди рдмрдЬрд╛рдЙрди рд╕рдХрд┐рдПрдиред'),
          backgroundColor: Colors.red,
          duration: Duration(seconds: 2),
        ),
      );
    }
  }

  // Audio Toggles for Content Screens
  Future<void> _toggleInfoAudio() async {
    if (_isInfoAudioPlaying) {
      await _stopAudio();
    } else {
      await _playAudio('assets/audio/info_content.mp3');
    }
  }

  Future<void> _toggleDosDontsAudio() async {
    if (_isDosDontsAudioPlaying) {
      await _stopAudio();
    } else {
      await _playAudio('assets/audio/dos_donts_content.mp3');
    }
  }

  Future<void> _toggleRetrofittingAudio() async {
    if (_isRetrofittingAudioPlaying) {
      await _stopAudio();
    } else {
      await _playAudio('assets/audio/retrofitting_content.mp3');
    }
  }

  // Phone Call
  Future<void> _makePhoneCall(String phoneNumber) async {
    final Uri phoneUri = Uri(scheme: 'tel', path: phoneNumber);
    if (await canLaunchUrl(phoneUri)) {
      await launchUrl(phoneUri);
    } else {
      ScaffoldMessenger.of(context).showSnackBar(
        const SnackBar(
          content: Text('рдлреЛрди рдХрд▓ рдЧрд░реНрди рд╕рдХрд┐рдПрдиред'),
          backgroundColor: Colors.red,
          duration: Duration(seconds: 2),
        ),
      );
    }
    Vibration.vibrate(duration: 50);
  }

  // Menu Audio
  final List<String> _menuAudioFiles = [
    'assets/audio/samanya_jankari.mp3',
    'assets/audio/apatkalin_sampark.mp3',
    'assets/audio/garnuparne_nagarnuparne.mp3',
    'assets/audio/retrofit.mp3',
    'assets/audio/khelharu.mp3',
    '', // Placeholder for Credits (no audio)
  ];

  // Content from InfoScreen
  final String _infoContent = '''
рдХреЗ рд╣реЛ рднреВрдХрдореНрдк?

рднреВрдХрдореНрдк рдкреГрдереНрд╡реАрдХреЛ рднрд┐рддреНрд░реА рд╕рддрд╣рдорд╛ рд╣реБрдиреЗ рд╣рд▓рдЪрд▓рдХреЛ рдкрд░рд┐рдгрд╛рдо рд╣реЛ, рдЬреБрди рдкреНрд░рд╛рдпрдГ рдЯреЗрдХреНрдЯреЛрдирд┐рдХ рдкреНрд▓реЗрдЯрд╣рд░реВрдХреЛ рдЖрдкрд╕реА рдЯрдХреНрдХрд░ рд╡рд╛ рдЪрд╛рдкрд▓реЗ рдЙрддреНрдкрдиреНрди рд╣реБрдиреНрдЫред рдЬрдм рдпреА рдкреНрд▓реЗрдЯрд╣рд░реВ рдЪрд▓рд╛рдпрдорд╛рди рд╣реБрдиреНрдЫрдиреН, рдКрд░реНрдЬрд╛ рд╕рддрд╣рдорд╛ рдкрд╣реБрдБрдЪреНрджрдЫ, рдЬрд╕рд▓реЗ рдЬрдорд┐рди рд╣рд▓реНрд▓рд┐рдиреНрдЫред рдпреЛ рд╣рд▓рдЪрд▓рд▓реЗ рднрд╡рди, рд╕рдбрдХ, рд░ рдЕрдиреНрдп рд╕рдВрд░рдЪрдирд╛рд╣рд░реВрд▓рд╛рдИ рдХреНрд╖рддрд┐ рдкреБрд░реНтАНрдпрд╛рдЙрди рд╕рдХреНрдЫ, рд░ рдХрд╣рд┐рд▓реЗрдХрд╛рд╣реАрдБ рдорд╛рдирд╡реАрдп рдЬреАрд╡рдирдХрд╛ рд▓рд╛рдЧрд┐ рдкрдирд┐ рдЦрддрд░рд╛ рд╕рд┐рд░реНрдЬрдирд╛ рдЧрд░реНрдЫред рднреВрдХрдореНрдкрдХреЛ рддреАрд╡реНрд░рддрд╛ рд░ рдкреНрд░рднрд╛рд╡ рдореБрдЦреНрдп рд░реВрдкрдорд╛ рдореНрдпрд╛рдЧреНрдирд┐рдЪреНрдпреБрдб рд░ рдЧрд╣рд┐рд░рд╛рдЗрдорд╛ рдирд┐рд░реНрднрд░ рдЧрд░реНрдЫред

рдиреЗрдкрд╛рд▓рдХреЛ рднреВрдХрдореНрдкреАрдп рдЬреЛрдЦрд┐рдо

рдиреЗрдкрд╛рд▓ рд╣рд┐рдорд╛рд▓рдп рдХреНрд╖реЗрддреНрд░рдорд╛ рдЕрд╡рд╕реНрдерд┐рдд рдЫ, рдЬреБрди рд╡рд┐рд╢реНрд╡рдХреИ рд╕рдмреИрднрдиреНрджрд╛ рд╕рдХреНрд░рд┐рдп рднреВрдХрдореНрдкреАрдп рдХреНрд╖реЗрддреНрд░рдордзреНрдпреЗ рдПрдХ рд╣реЛред рдпреЛ рджреЗрд╢ рднрд╛рд░рддреАрдп рд░ рдпреБрд░реЗрд╕рд┐рдпрди рдЯреЗрдХреНрдЯреЛрдирд┐рдХ рдкреНрд▓реЗрдЯрдХреЛ рд╕рдЩреНрдХреБрдЪрди рдХреНрд╖реЗрддреНрд░рдорд╛ рдкрд░реНрдЫ, рдЬрд╕рд▓реЗ рдЧрд░реНрджрд╛ рдпрд╣рд╛рдБ рд╡рд╛рд░реНрд╖рд┐рдХ рд░реВрдкрдорд╛ рд╕рд╛рдирд╛-рдареВрд▓рд╛ рднреВрдХрдореНрдкрд╣рд░реВ рд╣реБрдиреЗ рдЧрд░реНрдЫрдиреНред рдиреЗрдкрд╛рд▓рдорд╛ рд╣рд░реЗрдХ рд╡рд░реНрд╖ рдФрд╕рддрдорд╛ релреж рднрдиреНрджрд╛ рдмрдвреА рднреВрдХрдореНрдк рдорд╣рд╕реБрд╕ рд╣реБрдиреНрдЫрдиреН, рд░ рдордзреНрдпреЗрдорд╛ рдХреЗрд╣реАрд▓реЗ рдареВрд▓реЛ рдХреНрд╖рддрд┐ рдкреБрд░реНтАНрдпрд╛рдЙрдБрдЫрдиреНред рд╕рдЬрдЧрддрд╛, рд╕рддрд░реНрдХрддрд╛, рд░ рдкреВрд░реНрд╡ рддрдпрд╛рд░реАрд▓реЗ рдорд╛рддреНрд░ рд╣рд╛рдореА рдпреА рдкреНрд░рд╛рдХреГрддрд┐рдХ рд╡рд┐рдкрджреНрдХреЛ рдЬреЛрдЦрд┐рдо рдХрдо рдЧрд░реНрди рд╕рдХреНрдЫреМрдВред рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧ рдЬрд╕реНрддрд╛ рд╡рд┐рдзрд┐рд╣рд░реВрд▓реЗ рдкреБрд░рд╛рдирд╛ рднрд╡рдирд╣рд░реВрд▓рд╛рдИ рднреВрдХрдореНрдк рдкреНрд░рддрд┐рд░реЛрдзреА рдмрдирд╛рдЙрди рд╕рдХрд┐рдиреНрдЫ, рдЬрд╕рд▓реЗ рдЬреАрд╡рди рд░ рд╕рдореНрдкрддреНрддрд┐рдХреЛ рдХреНрд╖рддрд┐ рдиреНрдпреВрдиреАрдХрд░рдг рдЧрд░реНрдЫред

рдиреЗрдкрд╛рд▓рдХрд╛ рдкреНрд░рдореБрдЦ рднреВрдХрдореНрдкрд╣рд░реВ

рдиреЗрдкрд╛рд▓рдХреЛ рдЗрддрд┐рд╣рд╛рд╕рдорд╛ рдзреЗрд░реИ рд╡рд┐рдирд╛рд╢рдХрд╛рд░реА рднреВрдХрдореНрдкрд╣рд░реВ рднрдПрдХрд╛ рдЫрдиреН, рдЬрд╕рд▓реЗ рджреЗрд╢рдХреЛ рд╕рдВрд░рдЪрдирд╛ рд░ рдЬрдирдЬреАрд╡рдирдорд╛ рдЧрд╣рд┐рд░реЛ рдкреНрд░рднрд╛рд╡ рдкрд╛рд░реЗрдХрд╛ рдЫрдиреНред рдпрд╣рд╛рдБ рдХреЗрд╣реА рдЙрд▓реНрд▓реЗрдЦрдиреАрдп рдШрдЯрдирд╛рд╣рд░реВ рдЫрдиреН:

рд╡рд┐.рд╕рдВ. резрепрепреж (рд╕рдиреН резрепрейрек): рдмрд┐рд╣рд╛рд░-рдиреЗрдкрд╛рд▓ рднреВрдХрдореНрдк
рдореНрдпрд╛рдЧреНрдирд┐рдЪреНрдпреБрдб рео.реж рдХреЛ рдпреЛ рднреВрдХрдореНрдкрд▓реЗ рдХрд╛рдардорд╛рдбреМрдВ рдЙрдкрддреНрдпрдХрд╛ рд░ рдкреВрд░реНрд╡реА рдиреЗрдкрд╛рд▓рдорд╛ рдареВрд▓реЛ рд╡рд┐рдирд╛рд╢ рдордЪреНрдЪрд╛рдпреЛред рдХрд░рд┐рдм резреж,режрежреж рдорд╛рдирд┐рд╕рдХреЛ рдореГрддреНрдпреБ рднрдпреЛ, рд░ рд╕рдпреМрдВ рдЧрд╛рдЙрдБрд╣рд░реВ рдкреВрд░реНрдг рд░реВрдкрдорд╛ рдзреНрд╡рд╕реНрдд рднрдПред рдЖрд░реНрдерд┐рдХ рдХреНрд╖рддрд┐ рд░ рдмрд╕реНрддреАрдХреЛ рдкреБрдирд░реНрдирд┐рд░реНрдорд╛рдгрдорд╛ рджрд╢рдХреМрдБ рд▓рд╛рдЧреНрдпреЛред
рд╡рд┐.рд╕рдВ. реирежрезрел (рд╕рдиреН резрепрелрек): рдбреЛрдЯреА рднреВрдХрдореНрдк
рдореНрдпрд╛рдЧреНрдирд┐рдЪреНрдпреБрдб рем.рел рдХреЛ рдпреЛ рднреВрдХрдореНрдкрд▓реЗ рд╕реБрджреВрд░рдкрд╢реНрдЪрд┐рдо рдиреЗрдкрд╛рд▓рдорд╛ рдХрд░рд┐рдм резрелреж рдЬрдирд╛рдХреЛ рдЬyan рд▓рд┐рдпреЛ рд░ рдзреЗрд░реИ рдШрд░рд╣рд░реВ рднрддреНрдХрд╛рдПред рдпреЛ рдШрдЯрдирд╛рд▓реЗ рдкрд╣рд╛рдбреА рдХреНрд╖реЗрддреНрд░рдорд╛ рднреВрдХрдореНрдкрдХреЛ рдЬреЛрдЦрд┐рдорд▓рд╛рдИ рдкреБрдирдГ рдЙрдЬрд╛рдЧрд░ рдЧрд░реНтАНрдпреЛред
рд╡рд┐.рд╕рдВ. реирежрекрел (рд╕рдиреН резрепреорео): рдЙрддреНрддрд░реА рдзрдирдХреБрдЯрд╛ рднреВрдХрдореНрдк
рдореНрдпрд╛рдЧреНрдирд┐рдЪреНрдпреБрдб рем.реп рдХреЛ рдпреЛ рднреВрдХрдореНрдкрд▓реЗ рдкреВрд░реНрд╡реА рдиреЗрдкрд╛рд▓рдорд╛ рез,режрежреж рднрдиреНрджрд╛ рдмрдвреАрдХреЛ рдореГрддреНрдпреБ рд░ рд╣рдЬрд╛рд░реМрдВрдХреЛ рд╡рд┐рд╕реНрдерд╛рдкрди рдЧрд░рд╛рдпреЛред рд╕рдбрдХ рд░ рдкреБрд▓рд╣рд░реВрдорд╛ рдареВрд▓реЛ рдХреНрд╖рддрд┐ рднрдпреЛ, рдЬрд╕рд▓реЗ рдЙрджреНрдзрд╛рд░ рдХрд╛рд░реНрдпрдорд╛ рдмрд╛рдзрд╛ рдкреБрд░реНтАНрдпрд╛рдпреЛред
рд╡рд┐.рд╕рдВ. реирежренреи (рд╕рдиреН реирежрезрел): рдЧреЛрд░рдЦрд╛ рднреВрдХрдореНрдк
рдореНрдпрд╛рдЧреНрдирд┐рдЪреНрдпреБрдб рен.рео рдХреЛ рдпреЛ рд╡рд┐рдирд╛рд╢рдХрд╛рд░реА рднреВрдХрдореНрдкрд▓реЗ рдиреЗрдкрд╛рд▓рдХреЛ рдЗрддрд┐рд╣рд╛рд╕рдорд╛ рд╣рд╛рд▓рд╕рдореНрдордХреИ рдареВрд▓реЛ рдХреНрд╖рддрд┐ рдкреБрд░реНтАНрдпрд╛рдпреЛред реп,режрежреж рднрдиреНрджрд╛ рдмрдвреАрдХреЛ рдореГрддреНрдпреБ рднрдпреЛ, реиреи,режрежреж рднрдиреНрджрд╛ рдмрдвреА рдШрд╛рдЗрддреЗ рднрдП, рд░ рем рд▓рд╛рдЦрднрдиреНрджрд╛ рдмрдвреА рдШрд░рд╣рд░реВ рдкреВрд░реНрдг рд╡рд╛ рдЖрдВрд╢рд┐рдХ рд░реВрдкрдорд╛ рдзреНрд╡рд╕реНрдд рднрдПред рдЖрд░реНрдерд┐рдХ рдиреЛрдХреНрд╕рд╛рдиреА рдХрд░рд┐рдм рен рдЕрд░реНрдм рдЕрдореЗрд░рд┐рдХреА рдбрд▓рд░ рдЕрдиреБрдорд╛рди рдЧрд░рд┐рдПрдХреЛ рдЫред
рд╡рд┐.рд╕рдВ. реирежреореж (рд╕рдиреН реирежреирей): рдкрд╢реНрдЪрд┐рдо рдиреЗрдкрд╛рд▓ рднреВрдХрдореНрдк
рдореНрдпрд╛рдЧреНрдирд┐рдЪреНрдпреБрдб рем.рек рдХреЛ рдпреЛ рднреВрдХрдореНрдкрд▓реЗ рдЬрд╛рдЬрд░рдХреЛрдЯ рд░ рд░реБрдХреБрдо рдХреНрд╖реЗрддреНрд░рдорд╛ рдареВрд▓реЛ рдкреНрд░рднрд╛рд╡ рдкрд╛рд░реНрдпреЛред резрелрен рдЬрдирд╛рдХреЛ рдореГрддреНрдпреБ рднрдпреЛ, рд░ реирелрем рднрдиреНрджрд╛ рдмрдвреА рдШрд╛рдЗрддреЗ рднрдПред рдкрд╣рд╛рдбреА рднреВрднрд╛рдЧрдорд╛ рдкрд╣рд┐рд░реЛрдХреЛ рдЬреЛрдЦрд┐рдорд▓реЗ рдЙрджреНрдзрд╛рд░ рдХрд╛рд░реНрдпрдорд╛ рдердк рдЪреБрдиреМрддреА рдердкрд┐рдПрдХреЛ рдерд┐рдпреЛред
рднреВрдХрдореНрдк рддрдпрд╛рд░реАрдХреЛ рдорд╣рддреНрддреНрд╡

рдпреА рдШрдЯрдирд╛рд╣рд░реВрд▓реЗ рдиреЗрдкрд╛рд▓рдорд╛ рднреВрдХрдореНрдк рддрдпрд╛рд░реА рд░ рдмрд▓рд┐рдпреЛ рд╕рдВрд░рдЪрдирд╛рдХреЛ рдЖрд╡рд╢реНрдпрдХрддрд╛рд▓рд╛рдИ рдкреНрд░рд╕реНрдЯ рд░реВрдкрдорд╛ рджреЗрдЦрд╛рдЙрдБрдЫрдиреНред рднреВрдХрдореНрдкрдмрд╛рдЯ рдмрдЪреНрдирдХреЛ рд▓рд╛рдЧрд┐ рдкрд░рд┐рд╡рд╛рд░рд╕рдБрдЧ рдЖрдкрддрдХрд╛рд▓реАрди рдпреЛрдЬрдирд╛ рдмрдирд╛рдЙрдиреБрд╣реЛрд╕реН, рд╕реБрд░рдХреНрд╖рд┐рдд рдард╛рдЙрдБ рдкрд╣рд┐рдЪрд╛рди рдЧрд░реНрдиреБрд╣реЛрд╕реН, рд░ рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮрд╕рдБрдЧ рдкрд░рд╛рдорд░реНрд╢ рд▓рд┐рдиреБрд╣реЛрд╕реНред рдпреЛ рдЬрд╛рдирдХрд╛рд░реАрд▓реЗ рдорд╛рддреНрд░ рдирднрдИ, рдпреЛ рдПрдкрдХреЛ рдЕрдиреНрдп рдЦрдгреНрдбрд╣рд░реВ (рдЬрд╕реНрддреИ: рдЖрдкрддрдХрд╛рд▓реАрди рд╕рдореНрдкрд░реНрдХ, рдЧрд░реНрдиреБрдкрд░реНрдиреЗ/рдирдЧрд░реНрдиреЗ рдХреБрд░рд╛рд╣рд░реВ, рд░ рдЦреЗрд▓рд╣рд░реВ) рдкреНрд░рдпреЛрдЧ рдЧрд░реЗрд░ рдЖрдлреНрдиреЛ рд░ рдЖрдлреНрдиреЛ рдкрд░рд┐рд╡рд╛рд░рдХреЛ рд╕реБрд░рдХреНрд╖рд╛рдХреЛ рд▓рд╛рдЧрд┐ рддрдпрд╛рд░ рд░рд╣рди рд╕рд┐рдХреНрдиреБрд╣реЛрд╕реНред
  ''';

  // Content from EmergencyContactsScreen
  final List<Map<String, String>> _emergencyContacts = const [
    {'name': 'рд░рд╛рд╖реНрдЯреНрд░рд┐рдп рдЖрдкрддрдХрд╛рд▓реАрди рдирдореНрдмрд░ (рдиреЗрдкрд╛рд▓ рдкреНрд░рд╣рд░реА)', 'number': '100'},
    {'name': 'рдЕрдЧреНрдирд┐ рдирд┐рдпрдиреНрддреНрд░рдг (Fire Brigade / Dhamkal Service)', 'number': '101'},
    {'name': 'рдПрдореНрдмреБрд▓реЗрдиреНрд╕ рд╕реЗрд╡рд╛ (National Ambulance)', 'number': '102'},
    {'name': 'рд░рд╛рд╖реНрдЯреНрд░рд┐рдп рднреВрдХрдореНрдк рдорд╛рдкрди рдХреЗрдиреНрджреНрд░', 'number': '01-5522322'},
    {'name': 'рдиреЗрдкрд╛рд▓ рд░реЗрдбрдХреНрд░рд╕ рд╕реЛрд╕рд╛рдЗрдЯреА', 'number': '01-4270650'},
    {'name': 'рд░рд╛рд╖реНрдЯреНрд░рд┐рдп рдЖрддреНрдорд╣рддреНрдпрд╛ рд░реЛрдХрдерд╛рдо рд╣рдЯрд▓рд╛рдЗрди', 'number': '1166'},
    {'name': 'рдорд╛рдирд╕рд┐рдХ рдЕрд╕реНрдкрддрд╛рд▓, рд▓рд▓рд┐рддрдкреБрд░ (Mental Hospital, Lagankhel)', 'number': '01-5521333'},
    {'name': 'рдХрд╛рдиреНрддрд┐ рдмрд╛рд▓ рдЕрд╕реНрдкрддрд╛рд▓ (Child and Adolescent Psychiatry Unit)', 'number': '01-4225311'},
    {'name': 'рдЯрд┐рдпреБ рд╢рд┐рдХреНрд╖рдг рдЕрд╕реНрдкрддрд╛рд▓ (TU Teaching Hospital - Mental Health Support)', 'number': '01-4502011'},
    {'name': 'рдкреНрд░рджреЗрд╢ рдирдВ. рез рдкреНрд░рд╣рд░реА рдХрд╛рд░реНрдпрд╛рд▓рдп (Province 1 Police)', 'number': '021-521212'},
    {'name': 'рдкреНрд░рджреЗрд╢ рдирдВ. реи рдкреНрд░рд╣рд░реА рдХрд╛рд░реНрдпрд╛рд▓рдп (Province 2 Police)', 'number': '041-521212'},
    {'name': 'рдмрд╛рдЧрдорддреА рдкреНрд░рджреЗрд╢ рдкреНрд░рд╣рд░реА рдХрд╛рд░реНрдпрд╛рд▓рдп (Bagmati Province Police)', 'number': '01-4261111'},
    {'name': 'рдЧрдгреНрдбрдХреА рдкреНрд░рджреЗрд╢ рдкреНрд░рд╣рд░реА рдХрд╛рд░реНрдпрд╛рд▓рдп (Gandaki Province Police)', 'number': '061-521212'},
    {'name': 'рд▓реБрдореНрдмрд┐рдиреА рдкреНрд░рджреЗрд╢ рдкреНрд░рд╣рд░реА рдХрд╛рд░реНрдпрд╛рд▓рдп (Lumbini Province Police)', 'number': '081-521212'},
    {'name': 'рдХрд░реНрдгрд╛рд▓реА рдкреНрд░рджреЗрд╢ рдкреНрд░рд╣рд░реА рдХрд╛рд░реНрдпрд╛рд▓рдп (Karnali Province Police)', 'number': '083-521212'},
    {'name': 'рд╕реБрджреВрд░рдкрд╢реНрдЪрд┐рдо рдкреНрд░рджреЗрд╢ рдкреНрд░рд╣рд░реА рдХрд╛рд░реНрдпрд╛рд▓рдп (Sudurpashchim Province Police)', 'number': '091-521212'},
    {'name': 'рдХрд╛рдардорд╛рдбреМрдВ рдЕрдЧреНрдирд┐ рдирд┐рдпрдиреНрддреНрд░рдг (Kathmandu Fire Brigade)', 'number': '01-4221111'},
    {'name': 'рд▓рд▓рд┐рддрдкреБрд░ рдЕрдЧреНрдирд┐ рдирд┐рдпрдиреНрддреНрд░рдг (Lalitpur Fire Brigade)', 'number': '01-5521111'},
    {'name': 'рд░рд╛рд╖реНрдЯреНрд░рд┐рдп рд╡рд┐рдкрджреН рдкреНрд░рддрд┐рдХрд╛рд░реНрдп рд╣рдЯрд▓рд╛рдЗрди (National Disaster Response)', 'number': '1149'},
    {'name': 'рд╣реЗрд▓рд┐рдХрдкреНрдЯрд░ рдЙрджреНрдзрд╛рд░ рд╕реЗрд╡рд╛ (Helicopter Rescue Service)', 'number': '01-4256909'},
    {'name': 'рдкрд░реНрдпрдЯрдХ рдкреНрд░рд╣рд░реА (Tourist Police Hotline)', 'number': '1144'},
    {'name': 'рдкрд░реНрдпрдЯрдХ рдкреНрд░рд╣рд░реА, рднреГрдХреБрдЯреАрдордгреНрдбрдк (Tourist Police, Bhrikuti Mandap)', 'number': '01-4247041'},
    {'name': 'рдиреЗрдкрд╛рд▓ рдкрд░реНрдпрдЯрди рдмреЛрд░реНрдб (Nepal Tourism Board)', 'number': '01-4256909'},
    {'name': 'рдХрд╛рдардорд╛рдбреМрдВ рдореЛрдбреЗрд▓ рдЕрд╕реНрдкрддрд╛рд▓ рдПрдореНрдмреБрд▓реЗрдиреНрд╕ (Kathmandu Model Hospital)', 'number': '01-4240805'},
    {'name': 'рд▓рд▓рд┐рддрдкреБрд░ рдирдЧрд░рдкрд╛рд▓рд┐рдХрд╛ рдПрдореНрдмреБрд▓реЗрдиреНрд╕ (Lalitpur Municipality)', 'number': '01-5527003'},
    {'name': 'рдкрд░реЛрдкрдХрд╛рд░ рдПрдореНрдмреБрд▓реЗрдиреНрд╕ (Paropakar Ambulance)', 'number': '01-4251614'},
    {'name': 'рдЯреНрд░рд╛рдлрд┐рдХ рдкреНрд░рд╣рд░реА (Traffic Police)', 'number': '103'},
    {'name': 'рдмрд╛рд▓ рд╣реЗрд▓реНрдкрд▓рд╛рдЗрди (Child Helpline)', 'number': '104'},
    {'name': 'рд╣рд░рд╛рдЗрд░рд╣реЗрдХрд╛ рдмрд╛рд▓рдмрд╛рд▓рд┐рдХрд╛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ (Missing Child Response)', 'number': '1098'},
    {'name': 'рд╣реЗрд▓реНрдкрд▓рд╛рдЗрди (Nepal Telecom Helpline)', 'number': '197'},
  ];

  // Content from DosDontsScreen
  final List<String> _dos = const [
    'ЁЯзШ рд╢рд╛рдиреНрдд рд░рд╣рдиреБрд╣реЛрд╕реН тАУ рдбрд░рд╛рдЙрдиреБ рднрдПрди, рд╣реЛрд╕рд┐рдпрд╛рд░ рд╣реБрдиреБрд╣реЛрд╕реН',
    'ЁЯзОтАНтЩВя╕П Drop, ЁЯЫП Cover, тЬЛ Hold рдЕрдкрдирд╛рдЙрдиреБрд╣реЛрд╕реН (Drop: рдШреБрдБрдбрд╛рдорд╛ рдмрд╕реНрдиреБрд╣реЛрд╕реН, Cover: рдЯреЗрдмреБрд▓рдореБрдирд┐ рд▓реБрдХреНрдиреБрд╣реЛрд╕реН, Hold: рдЯреЗрдмреБрд▓ рд╕рдорд╛рддреНрдиреБрд╣реЛрд╕реН)',
    'ЁЯМ│ рдЦреБрд▓рд╛ рдард╛рдЙрдБ рдирдЬрд┐рдХ рд╣реБрдиреБрд╣реБрдиреНрдЫ рднрдиреЗ рддреНрдпрддрд╛ рдЬрд╛рдиреБрд╣реЛрд╕реН (рдмрд┐рдЬреБрд▓реАрдХреЛ рдкреЛрд▓ рд╡рд╛ рднрд╡рдирдмрд╛рдЯ рдЯрд╛рдврд╛)',
    'ЁЯЫС рдЧреНрдпрд╛рд╕ рд░ рдмрд┐рдЬреБрд▓реА рдмрдиреНрдж рдЧрд░реНрдиреБрд╣реЛрд╕реН рдпрджрд┐ рд╕реБрд░рдХреНрд╖рд┐рдд рд░реБрдкрдорд╛ рдЧрд░реНрди рд╕рдХрд┐рдиреНрдЫ рднрдиреЗ',
    'ЁЯОТ рдЖрдкрддрдХрд╛рд▓реАрди рдХрд┐рдЯ рддрдпрд╛рд░ рд░рд╛рдЦреНрдиреБрд╣реЛрд╕реН тАУ рдЯрд░реНрдЪ, рдФрд╖рдзрд┐, рдкрд╛рдиреА, рд╕рд╛рдирд╛ рдЦрд╛рджреНрдпрдкрджрд╛рд░реНрде',
    'ЁЯУ╗ рд░реЗрдбрд┐рдпреЛ рд╡рд╛ рдореЛрдмрд╛рдЗрд▓рдмрд╛рдЯ рд╕реВрдЪрдирд╛ рд╕реБрдиреНрдиреБрд╣реЛрд╕реН тАУ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рд╕реНрд░реЛрддрдорд╛ рднрд░рдкрд░реНрдиреБрд╣реЛрд╕реН',
  ];

  final List<String> _donts = const [
    'рдЦреБрд▓рд╛ рдард╛рдЙрдБрдорд╛ рдирднрд╛рдЧреНрдиреБрд╣реЛрд╕реН рдЬрдмрд╕рдореНрдо рд╕реБрд░рдХреНрд╖рд┐рдд рдЫреИрди',
    'рд╕рд┐рдБрдвреА рдкреНрд░рдпреЛрдЧ рдирдЧрд░реНрдиреБрд╣реЛрд╕реН',
    'рдЦрддрд░рдирд╛рдХ рдард╛рдЙрдБрдорд╛ рдирдЬрд╛рдиреБрд╣реЛрд╕реН',
    'рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧ рдмрд┐рдирд╛ рдкреБрд░рд╛рдиреЛ рднрд╡рдирдорд╛ рдирдмрд╕реНрдиреБрд╣реЛрд╕реН',
  ];

  // Content from RetrofittingScreen
  final String _retrofittingContent = '''
рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧ рднрдиреЗрдХреЛ рдХреЗ рд╣реЛ?
рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧ рднрдиреЗрдХреЛ рдкреБрд░рд╛рдирд╛ рднрд╡рдирд╣рд░реВрд▓рд╛рдИ рднреВрдХрдореНрдк рдкреНрд░рддрд┐рд░реЛрдзреА рдмрдирд╛рдЙрди рд╕рдВрд░рдЪрдирд╛рддреНрдордХ рд╕реБрдзрд╛рд░ рдЧрд░реНрдиреЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╣реЛред рдпрд╕рдорд╛ рднрд┐рддреНрддрд╛, рдкрд┐рд▓рд░, рд░ рдЬрдЧрд▓рд╛рдИ рдмрд▓рд┐рдпреЛ рдмрдирд╛рдЙрдиреЗ, рд╕реНрдЯрд┐рд▓ рдмреНрд░реЗрд╕рд┐рдВрдЧ рдердкреНрдиреЗ, рд╡рд╛ рдЕрдиреНрдп рдкреНрд░рд╛рд╡рд┐рдзрд┐рдХ рд╡рд┐рдзрд┐рд╣рд░реВ рдкреНрд░рдпреЛрдЧ рдЧрд░рд┐рдиреНрдЫред

рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧ рдХрд┐рди рдорд╣рддреНрддреНрд╡рдкреВрд░реНрдг рдЫ?
- рд╕реБрд░рдХреНрд╖рд╛: рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧрд▓реЗ рднреВрдХрдореНрдкрдХреЛ рд╕рдордпрдорд╛ рднрд╡рди рдврд▓реНрдиреЗ рдЬреЛрдЦрд┐рдо рдХрдо рдЧрд░реНрдЫ, рдЬрд╕рд▓реЗ рдорд╛рдирд╡реАрдп рдХреНрд╖рддрд┐ рдШрдЯрд╛рдЙрдБрдЫред
- рд▓рд╛рдЧрдд рдкреНрд░рднрд╛рд╡реА: рдирдпрд╛рдБ рднрд╡рди рдмрдирд╛рдЙрдиреБрднрдиреНрджрд╛ рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧ рд╕рд╕реНрддреЛ рд╣реБрдиреНрдЫред
- рд╕рдВрд░рдХреНрд╖рдг: рдРрддрд┐рд╣рд╛рд╕рд┐рдХ рд╡рд╛ рд╕рд╛рдВрд╕реНрдХреГрддрд┐рдХ рдорд╣рддреНрддреНрд╡рдХрд╛ рднрд╡рдирд╣рд░реВрд▓рд╛рдИ рдЬреЛрдЧрд╛рдЙрди рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧ рдЙрдкрдпреЛрдЧреА рдЫред
- рдкрд░реНрдпрд╛рд╡рд░рдгреАрдп рдлрд╛рдЗрджрд╛: рдирдпрд╛рдБ рдирд┐рд░реНрдорд╛рдгрдХреЛ рддреБрд▓рдирд╛рдорд╛ рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧрд▓реЗ рдХрдо рд╕реНрд░реЛрдд рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдЫред

рдХрд╣рд┐рд▓реЗ рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧ рдЧрд░реНрдиреЗ, рдирдпрд╛рдБ рдмрдирд╛рдЙрдиреЗ рд╣реЛрдЗрди?
- рднрд╡рдирдХреЛ рдЕрд╡рд╕реНрдерд╛: рдпрджрд┐ рднрд╡рдирдХреЛ рдЖрдзрд╛рд░рднреВрдд рд╕рдВрд░рдЪрдирд╛ рдмрд▓рд┐рдпреЛ рдЫ рд░ рдХреЗрд╡рд▓ рд╕реБрджреГрдвреАрдХрд░рдг рдЖрд╡рд╢реНрдпрдХ рдЫ рднрдиреЗ рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧ рдЙрдкрдпреБрдХреНрдд рд╣реБрдиреНрдЫред
- рдмрдЬреЗрдЯ: рдирдпрд╛рдБ рднрд╡рди рдмрдирд╛рдЙрди рдЖрд░реНрдерд┐рдХ рд╕реНрд░реЛрдд рдирднрдПрдорд╛ рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧ рд░рд╛рдореНрд░реЛ рд╡рд┐рдХрд▓реНрдк рд╣реЛред
- рд╕рдордп: рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧ рдЫрд┐рдЯреЛ рд╣реБрдиреНрдЫ, рдЬрдмрдХрд┐ рдирдпрд╛рдБ рдирд┐рд░реНрдорд╛рдгрдорд╛ рд╕рдордп рд▓рд╛рдЧреНрдЫред
- рд╕рд╛рдВрд╕реНрдХреГрддрд┐рдХ рдореВрд▓реНрдп: рдпрджрд┐ рднрд╡рди рдРрддрд┐рд╣рд╛рд╕рд┐рдХ рд╡рд╛ рд╕рд╛рдВрд╕реНрдХреГрддрд┐рдХ рд░реВрдкрдорд╛ рдорд╣рддреНрддреНрд╡рдкреВрд░реНрдг рдЫ рднрдиреЗ рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧ рдкреНрд░рд╛рдердорд┐рдХрддрд╛ рд╣реБрдиреНрдЫред
- рдареВрд▓реЛ рдХреНрд╖рддрд┐: рдпрджрд┐ рднрд╡рди рдкреВрд░реНрдг рд░реВрдкрдорд╛ рдХрдордЬреЛрд░ рд╡рд╛ рдзреНрд╡рд╕реНрдд рдЫ рднрдиреЗ рдирдпрд╛рдБ рдирд┐рд░реНрдорд╛рдг рдЙрдкрдпреБрдХреНрдд рд╣реБрдиреНрдЫред

рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮрд╕рдБрдЧ рдкрд░рд╛рдорд░реНрд╢ рд▓рд┐рдиреБрд╣реЛрд╕реН рд░ рдЖрдлреНрдиреЛ рдШрд░рдХреЛ рдореВрд▓реНрдпрд╛рдЩреНрдХрди рдЧрд░реНрдиреБрд╣реЛрд╕реНред
  ''';

  // Content from QuizScreen
  final List<Map<String, dynamic>> _quizQuestions = [
    {
      'question': 'рднреВрдХрдореНрдкрдХреЛ рд╕рдордпрдорд╛ рд╕рдмреИрднрдиреНрджрд╛ рд╕реБрд░рдХреНрд╖рд┐рдд рдХреБрди рд╣реЛ?',
      'options': ['рдЯреЗрдмрд▓ рдореБрдирд┐ рдмрд╕реНрдиреЗ', 'рд╕рд┐рдБрдвреАрдорд╛ рднрд╛рдЧреНрдиреЗ', 'рдЦреБрд▓рд╛ рдард╛рдЙрдБрдорд╛ рдЙрднрд┐рдиреЗ', 'рд▓рд┐рдлреНрдЯ рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреЗ'],
      'correct': 0,
      'explanation': 'рдЯреЗрдмрд▓ рдореБрдирд┐ рдмрд╕реНрджрд╛ рдЭрд░реНрдиреЗ рд╡рд╕реНрддреБрдмрд╛рдЯ рдЬреЛрдЧрд┐рди рд╕рдХрд┐рдиреНрдЫред'
    },
    {
      'question': 'рдЖрдкрддрдХрд╛рд▓реАрди рдЭреЛрд▓рд╛рдорд╛ рдХреЗ рд░рд╛рдЦреНрдиреБрдкрд░реНрдЫ?',
      'options': ['рдкрд╛рдиреА', 'рдЦреЗрд▓реМрдирд╛', 'рд▓рдХреНрдЬрд░реА рдЧрд╣рдирд╛', 'рдЯреЗрд▓рд┐рднрд┐рдЬрди'],
      'correct': 0,
      'explanation': 'рдкрд╛рдиреА рдЖрдкрддрдХрд╛рд▓реАрди рдЕрд╡рд╕реНрдерд╛рдорд╛ рдЬреАрд╡рди рд░рдХреНрд╖рд╛рдХреЛ рд▓рд╛рдЧрд┐ рдЖрд╡рд╢реНрдпрдХ рдЫред'
    },
    {
      'question': 'рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧрдХреЛ рдореБрдЦреНрдп рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд╣реЛ?',
      'options': ['рднрд╡рди рдмрд▓рд┐рдпреЛ рдмрдирд╛рдЙрдиреЗ', 'рднрд╡рди рд╕рдЬрд╛рдЙрдиреЗ', 'рднрд╡рди рдареВрд▓реЛ рдмрдирд╛рдЙрдиреЗ', 'рднрд╡рди рд╕рд╕реНрддреЛ рдмрдирд╛рдЙрдиреЗ'],
      'correct': 0,
      'explanation': 'рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧрд▓реЗ рднрд╡рдирд▓рд╛рдИ рднреВрдХрдореНрдк рдкреНрд░рддрд┐рд░реЛрдзреА рдмрдирд╛рдЙрдБрдЫред'
    },
    {
      'question': 'рднреВрдХрдореНрдк рдЕрднреНрдпрд╛рд╕рдХреЛ рдирд╛рдо рдХреЗ рд╣реЛ?',
      'options': ['Drop, Cover, Hold', 'Run, Hide, Seek', 'Jump, Duck, Roll', 'Stand, Watch, Wait'],
      'correct': 0,
      'explanation': 'Drop, Cover, Hold рднреВрдХрдореНрдкрдХреЛ рд╕рдордпрдорд╛ рд╕реБрд░рдХреНрд╖рд┐рдд рд░рд╣рдиреЗ рдЕрднреНрдпрд╛рд╕ рд╣реЛред'
    },
    {
      'question': 'рднреВрдХрдореНрдкрдХреЛ рд╕рдордпрдорд╛ рд╕рд┐рдБрдвреА рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреБ...',
      'options': ['рдЦрддрд░рдирд╛рдХ рд╣реЛ', 'рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реЛ', 'рдЖрд╡рд╢реНрдпрдХ рд╣реЛ', 'рд░рдорд╛рдЗрд▓реЛ рд╣реЛ'],
      'correct': 0,
      'explanation': 'рд╕рд┐рдБрдвреА рдкреНрд░рдпреЛрдЧ рдЧрд░реНрджрд╛ рдЪреЛрдЯрдкрдЯрдХ рд▓рд╛рдЧреНрдиреЗ рдЬреЛрдЦрд┐рдо рд╣реБрдиреНрдЫред'
    },
    {
      'question': 'рдЖрдкрддрдХрд╛рд▓реАрди рд╕рдореНрдкрд░реНрдХ рдпреЛрдЬрдирд╛ рдХрд┐рди рдорд╣рддреНрддреНрд╡рдкреВрд░реНрдг рдЫ?',
      'options': ['рдкрд░рд┐рд╡рд╛рд░рд▓рд╛рдИ рдЬреЛрдбреНрди', 'рдЦрд╛рдирд╛ рдкрдХрд╛рдЙрди', 'рдЯрд┐рднреА рд╣реЗрд░реНрди', 'рдЦреЗрд▓ рдЦреЗрд▓реНрди'],
      'correct': 0,
      'explanation': 'рд╕рдореНрдкрд░реНрдХ рдпреЛрдЬрдирд╛рд▓реЗ рдЖрдкрддрдХрд╛рд▓рдорд╛ рдкрд░рд┐рд╡рд╛рд░рд▓рд╛рдИ рдПрдХрдЬреБрдЯ рдЧрд░реНрди рдорджреНрджрдд рдЧрд░реНрдЫред'
    },
    {
      'question': 'рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧрд▓реЗ рдХреЗ рдХрдо рдЧрд░реНрдЫ?',
      'options': ['рднреВрдХрдореНрдкрдХреЛ рдХреНрд╖рддрд┐', 'рдШрд░рдХреЛ рдореВрд▓реНрдп', 'рдШрд░рдХреЛ рд╕рд╛рдЗрдЬ', 'рдмрд┐рдЬреБрд▓реА рдЦрдкрдд'],
      'correct': 0,
      'explanation': 'рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧрд▓реЗ рднреВрдХрдореНрдкрдХреЛ рд╕рдордпрдорд╛ рднрд╡рдирдХреЛ рдХреНрд╖рддрд┐ рдХрдо рдЧрд░реНрдЫред'
    },
    {
      'question': 'рднреВрдХрдореНрдкрдХреЛ рд╕рдордпрдорд╛ рдЯрд╛рдЙрдХреЛ рдХрд╕рд░реА рдЬреЛрдЧрд╛рдЙрдиреЗ?',
      'options': ['рд╣рд╛рддрд▓реЗ рдврд╛рдХреНрдиреЗ', 'рдХрдкрдбрд╛рд▓реЗ рдврд╛рдХреНрдиреЗ', 'рдХреБрдиреИ рдврд╛рдХреНрдиреБ рдирдкрд░реНрдиреЗ', 'рдкреНрд▓рд╛рд╕реНрдЯрд┐рдХрд▓реЗ рдврд╛рдХреНрдиреЗ'],
      'correct': 0,
      'explanation': 'рд╣рд╛рддрд▓реЗ рдЯрд╛рдЙрдХреЛ рдврд╛рдХреНрджрд╛ рдЭрд░реНрдиреЗ рд╡рд╕реНрддреБрдмрд╛рдЯ рдЬреЛрдЧрд┐рди рд╕рдХрд┐рдиреНрдЫред'
    },
    {
      'question': 'рдЖрдкрддрдХрд╛рд▓реАрди рдЭреЛрд▓рд╛рдорд╛ рдЦрд╛рдирд╛ рдХрддрд┐ рджрд┐рдирдХреЛ рд░рд╛рдЦреНрдиреЗ?',
      'options': ['рей рджрд┐рди', 'рез рджрд┐рди', 'рез рд╣рдкреНрддрд╛', 'рез рдорд╣рд┐рдирд╛'],
      'correct': 0,
      'explanation': 'рей рджрд┐рдирдХреЛ рдЦрд╛рдирд╛ рдЖрдкрддрдХрд╛рд▓реАрди рдЕрд╡рд╕реНрдерд╛рдХреЛ рд▓рд╛рдЧрд┐ рдкрд░реНрдпрд╛рдкреНрдд рд╣реБрдиреНрдЫред'
    },
    {
      'question': 'рднреВрдХрдореНрдкрдХреЛ рдЬреЛрдЦрд┐рдо рдХрдо рдЧрд░реНрди рдХреЗ рдЧрд░реНрдиреБрдкрд░реНрдЫ?',
      'options': ['рдкреВрд░реНрд╡ рддрдпрд╛рд░реА', 'рдЯрд┐рднреА рд╣реЗрд░реНрдиреЗ', 'рдЦреЗрд▓реНрдиреЗ', 'рд╕реБрддреНрдиреЗ'],
      'correct': 0,
      'explanation': 'рдкреВрд░реНрд╡ рддрдпрд╛рд░реАрд▓реЗ рднреВрдХрдореНрдкрдХреЛ рдЬреЛрдЦрд┐рдо рдХрдо рдЧрд░реНрди рд╕рдХрд┐рдиреНрдЫред'
    },
    {
      'question': 'рднреВрдХрдореНрдкрдХреЛ рд╕рдордпрдорд╛ рд▓рд┐рдлреНрдЯ рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреБ...',
      'options': ['рдЦрддрд░рдирд╛рдХ рд╣реЛ', 'рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реЛ', 'рдЖрд╡рд╢реНрдпрдХ рд╣реЛ', 'рд╕рдЬрд┐рд▓реЛ рд╣реЛ'],
      'correct': 0,
      'explanation': 'рд▓рд┐рдлреНрдЯрдорд╛ рдлрд╕реНрдиреЗ рдЬреЛрдЦрд┐рдо рд╣реБрдиреНрдЫ, рддреНрдпрд╕реИрд▓реЗ рдкреНрд░рдпреЛрдЧ рдЧрд░реНрдиреБ рд╣реБрдБрджреИрдиред'
    },
    {
      'question': 'рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧ рдХрд╕рд▓реЗ рдЧрд░реНрдиреБрдкрд░реНрдЫ?',
      'options': ['рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ', 'рд╕рдмреИрд▓реЗ', 'рдХрд╕реИрд▓реЗ рдкрдирд┐', 'рдмрдЪреНрдЪрд╛рд╣рд░реВрд▓реЗ'],
      'correct': 0,
      'explanation': 'рд╡рд┐рд╢реЗрд╖рдЬреНрдЮрд▓реЗ рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧ рдЧрд░реНрджрд╛ рд╕реБрд░рдХреНрд╖рд┐рдд рд░ рдкреНрд░рднрд╛рд╡рдХрд╛рд░реА рд╣реБрдиреНрдЫред'
    },
    {
      'question': 'рдЖрдкрддрдХрд╛рд▓реАрди рдЭреЛрд▓рд╛рдорд╛ рдлреНрд▓реНрдпрд╛рд╢рд▓рд╛рдЗрдЯ рдХрд┐рди рд░рд╛рдЦреНрдиреЗ?',
      'options': ['рдЙрдЬреНрдпрд╛рд▓реЛрдХреЛ рд▓рд╛рдЧрд┐', 'рдЦреЗрд▓реНрдирдХреЛ рд▓рд╛рдЧрд┐', 'рд╕рдЬрд╛рдЙрдирдХреЛ рд▓рд╛рдЧрд┐', 'рдмреЗрдЪреНрдирдХреЛ рд▓рд╛рдЧрд┐'],
      'correct': 0,
      'explanation': 'рдлреНрд▓реНрдпрд╛рд╢рд▓рд╛рдЗрдЯрд▓реЗ рдЕрдБрдзреНрдпрд╛рд░реЛрдорд╛ рдЙрдЬреНрдпрд╛рд▓реЛ рдкреНрд░рджрд╛рди рдЧрд░реНрдЫред'
    },
    {
      'question': 'рднреВрдХрдореНрдкрдХреЛ рд╕рдордпрдорд╛ рд╢рд╛рдиреНрдд рд░рд╣рдиреБ...',
      'options': ['рдорд╣рддреНрддреНрд╡рдкреВрд░реНрдг рд╣реЛ', 'рдЕрдирд╛рд╡рд╢реНрдпрдХ рд╣реЛ', 'рдЦрддрд░рдирд╛рдХ рд╣реЛ', 'рд░рдорд╛рдЗрд▓реЛ рд╣реЛ'],
      'correct': 0,
      'explanation': 'рд╢рд╛рдиреНрдд рд░рд╣рдБрджрд╛ рд╕рд╣реА рдирд┐рд░реНрдгрдп рд▓рд┐рди рд╕рдХрд┐рдиреНрдЫред'
    },
    {
      'question': 'рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧ рдмрд┐рдирд╛ рдкреБрд░рд╛рдиреЛ рднрд╡рди...',
      'options': ['рдЦрддрд░рдирд╛рдХ рд╣реБрдиреНрдЫ', 'рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реБрдиреНрдЫ', 'рд╕реБрдиреНрджрд░ рд╣реБрдиреНрдЫ', 'рд╕рд╕реНрддреЛ рд╣реБрдиреНрдЫ'],
      'correct': 0,
      'explanation': 'рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧ рдмрд┐рдирд╛ рдкреБрд░рд╛рдиреЛ рднрд╡рди рднреВрдХрдореНрдкрдорд╛ рдЬреЛрдЦрд┐рдордкреВрд░реНрдг рд╣реБрдиреНрдЫред'
    },
    {
      'question': 'рдЖрдкрддрдХрд╛рд▓реАрди рдЭреЛрд▓рд╛рдорд╛ рд░реЗрдбрд┐рдпреЛ рдХрд┐рди рд░рд╛рдЦреНрдиреЗ?',
      'options': ['рд╕реВрдЪрдирд╛ рд╕реБрдиреНрди', 'рдЧрд╛рдирд╛ рд╕реБрдиреНрди', 'рдЦреЗрд▓реНрди', 'рд╕рдЬрд╛рдЙрди'],
      'correct': 0,
      'explanation': 'рд░реЗрдбрд┐рдпреЛрд▓реЗ рдЖрдкрддрдХрд╛рд▓реАрди рд╕реВрдЪрдирд╛ рдкреНрд░рд╛рдкреНрдд рдЧрд░реНрди рдорджреНрджрдд рдЧрд░реНрдЫред'
    },
    {
      'question': 'рднреВрдХрдореНрдкрдХреЛ рд╕рдордпрдорд╛ рдЦреБрд▓рд╛ рдард╛рдЙрдБрдорд╛ рдХрд╣рд┐рд▓реЗ рдЬрд╛рдиреЗ?',
      'options': ['рд╕реБрд░рдХреНрд╖рд┐рдд рднрдПрдкрдЫрд┐', 'рддреБрд░реБрдиреНрддреИ', 'рдХрд╣рд┐рд▓реНрдпреИ рдирдЬрд╛рдиреЗ', 'рд░рд╛рддрд┐ рдорд╛рддреНрд░'],
      'correct': 0,
      'explanation': 'рд╕реБрд░рдХреНрд╖рд┐рдд рднрдПрдкрдЫрд┐ рдорд╛рддреНрд░ рдЦреБрд▓рд╛ рдард╛рдЙрдБрдорд╛ рдЬрд╛рдиреБ рдЙрдЪрд┐рдд рд╣реБрдиреНрдЫред'
    },
    {
      'question': 'рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧрд▓реЗ рднрд╡рдирдХреЛ рдЖрдпреБ...',
      'options': ['рдмрдврд╛рдЙрдБрдЫ', 'рдШрдЯрд╛рдЙрдБрдЫ', 'рдкрд░рд┐рд╡рд░реНрддрди рдЧрд░реНрджреИрди', 'рд╢реВрдиреНрдп рдмрдирд╛рдЙрдБрдЫ'],
      'correct': 0,
      'explanation': 'рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧрд▓реЗ рднрд╡рдирдХреЛ рдмрд▓рд┐рдпреЛрдкрди рд░ рдЖрдпреБ рдмрдврд╛рдЙрдБрдЫред'
    },
    {
      'question': 'рдЖрдкрддрдХрд╛рд▓реАрди рдЭреЛрд▓рд╛рдорд╛ рдкреНрд░рд╛рдердорд┐рдХ рдЙрдкрдЪрд╛рд░ рдХрд┐рдЯ...',
      'options': ['рдЖрд╡рд╢реНрдпрдХ рдЫ', 'рдЕрдирд╛рд╡рд╢реНрдпрдХ рдЫ', 'рдЦрддрд░рдирд╛рдХ рдЫ', 'рд╕рдЬрд╛рд╡рдЯреА рдЫ'],
      'correct': 0,
      'explanation': 'рдкреНрд░рд╛рдердорд┐рдХ рдЙрдкрдЪрд╛рд░ рдХрд┐рдЯрд▓реЗ рд╕рд╛рдиреЛрддрд┐рдиреЛ рдЪреЛрдЯрдкрдЯрдХрдХреЛ рдЙрдкрдЪрд╛рд░рдорд╛ рд╕рд╣рдпреЛрдЧ рдЧрд░реНрдЫред'
    },
    {
      'question': 'рднреВрдХрдореНрдкрдХреЛ рддрдпрд╛рд░реАрд▓реЗ рдХреЗ рдЧрд░реНрдЫ?',
      'options': ['рдЬреЛрдЦрд┐рдо рдХрдо рдЧрд░реНрдЫ', 'рдЬреЛрдЦрд┐рдо рдмрдврд╛рдЙрдБрдЫ', 'рдХреБрдиреИ рдкреНрд░рднрд╛рд╡ рдкрд╛рд░реНрджреИрди', 'рдордиреЛрд░рдЮреНрдЬрди рджрд┐рдиреНрдЫ'],
      'correct': 0,
      'explanation': 'рддрдпрд╛рд░реАрд▓реЗ рднреВрдХрдореНрдкрдХреЛ рдЬреЛрдЦрд┐рдо рд░ рдХреНрд╖рддрд┐ рдХрдо рдЧрд░реНрдЫред'
    },
  ];
  List<Map<String, dynamic>> _quizSelectedQuestions = [];

  // Content from EmergencyKitGameScreen
  final List<Map<String, dynamic>> _gameItems = [
    {'name': 'рдкрд╛рдиреА', 'isCorrect': true},
    {'name': 'рдЦрд╛рдирд╛', 'isCorrect': true},
    {'name': 'рдкреНрд░рд╛рдердорд┐рдХ рдЙрдкрдЪрд╛рд░ рдХрд┐рдЯ', 'isCorrect': true},
    {'name': 'рдлреНрд▓реНрдпрд╛рд╢рд▓рд╛рдЗрдЯ', 'isCorrect': true},
    {'name': 'рд░реЗрдбрд┐рдпреЛ', 'isCorrect': true},
    {'name': 'рдХрдкрдбрд╛', 'isCorrect': true},
    {'name': 'рдХрд╛рдЧрдЬрд╛рддрдХреЛ рдкреНрд░рддрд┐рд▓рд┐рдкрд┐', 'isCorrect': true},
    {'name': 'рдЯреЗрд▓рд┐рднрд┐рдЬрди', 'isCorrect': false},
    {'name': 'рдЦреЗрд▓реМрдирд╛', 'isCorrect': false},
    {'name': 'рд▓рдХреНрдЬрд░реА рдЧрд╣рдирд╛', 'isCorrect': false},
    {'name': 'рд▓реНрдпрд╛рдкрдЯрдк', 'isCorrect': false},
  ];

  // Quiz Logic
  void _answerQuestion(int selectedIndex) {
    setState(() {
      _quizUserAnswers[_quizCurrentQuestionIndex] = selectedIndex;
      _quizIsFeedbackShowing = true;
      if (selectedIndex == _quizSelectedQuestions[_quizCurrentQuestionIndex]['correct']) {
        _quizCorrectAnswers++;
        _quizFeedbackMessage = 'рддрдкрд╛рдИрдВ рднреВрдХрдореНрдк рд╕реБрд░рдХреНрд╖рд╛рдХреЛ рдмрд╛рдЯреЛрдорд╛ рд╣реБрдиреБрд╣реБрдиреНрдЫ!';
        ScaffoldMessenger.of(context).showSnackBar(
          SnackBar(
            content: Text(_quizFeedbackMessage!),
            backgroundColor: Colors.green,
            duration: const Duration(seconds: 3),
          ),
        );
      } else {
        _quizFeedbackMessage =
        'рдЧрд▓рдд! рд╕рд╣реА рдЬрд╡рд╛рдл: ${_quizSelectedQuestions[_quizCurrentQuestionIndex]['options'][_quizSelectedQuestions[_quizCurrentQuestionIndex]['correct']]}\nрд╡рд┐рд╡рд░рдг: ${_quizSelectedQuestions[_quizCurrentQuestionIndex]['explanation']}';
        ScaffoldMessenger.of(context).showSnackBar(
          SnackBar(
            content: Text(_quizFeedbackMessage!),
            backgroundColor: Colors.red,
            duration: const Duration(seconds: 3),
          ),
        );
      }
      Future.delayed(const Duration(seconds: 3), () {
        if (mounted && !_quizShowResults) {
          setState(() {
            _quizIsFeedbackShowing = false;
            _nextQuestion();
          });
        }
      });
    });
  }

  void _nextQuestion() {
    if (_quizCurrentQuestionIndex < 9) {
      _quizCurrentQuestionIndex++;
      _quizFeedbackMessage = null;
    } else {
      _quizShowResults = true;
    }
  }

  void _resetQuiz() {
    setState(() {
      _quizCurrentQuestionIndex = 0;
      _quizCorrectAnswers = 0;
      _quizUserAnswers = List<int?>.filled(10, null);
      _quizShowResults = false;
      _quizFeedbackMessage = null;
      _quizIsFeedbackShowing = false;
      _quizQuestions.shuffle(Random());
      _quizSelectedQuestions = _quizQuestions.take(10).toList();
      for (var question in _quizSelectedQuestions) {
        List<String> options = List.from(question['options']);
        int correctIndex = question['correct'];
        String correctAnswer = options[correctIndex];
        options.shuffle(Random());
        question['options'] = options;
        question['correct'] = options.indexOf(correctAnswer);
      }
    });
    Vibration.vibrate(duration: 50);
  }

  // Emergency Kit Game Logic
  void _selectGameItem(bool include) {
    if (_gameCurrentIndex >= _gameItems.length || _gameOver) return;
    setState(() {
      if (include && _gameItems[_gameCurrentIndex]['isCorrect']) {
        _gameCorrectCount++;
        ScaffoldMessenger.of(context).showSnackBar(
          const SnackBar(
            content: Text('рд╕рд╣реА рдЫ! рдпреЛ рдЖрдкрддрдХрд╛рд▓реАрди рдХрд┐рдЯрдХреЛ рд▓рд╛рдЧрд┐ рдЖрд╡рд╢реНрдпрдХ рдЫ!'),
            backgroundColor: Colors.green,
            duration: Duration(seconds: 2),
          ),
        );
      } else if (!include && !_gameItems[_gameCurrentIndex]['isCorrect']) {
        ScaffoldMessenger.of(context).showSnackBar(
          const SnackBar(
            content: Text('рд╕рд╣реА рдирд┐рд░реНрдгрдп! рдпреЛ рдЖрд╡рд╢реНрдпрдХ рдЫреИрдиред'),
            backgroundColor: Colors.green,
            duration: Duration(seconds: 2),
          ),
        );
      } else if (include && !_gameItems[_gameCurrentIndex]['isCorrect']) {
        ScaffoldMessenger.of(context).showSnackBar(
          const SnackBar(
            content: Text('рдЧрд▓рдд! рдпреЛ рдЖрд╡рд╢реНрдпрдХ рдЫреИрдиред'),
            backgroundColor: Colors.orange,
            duration: Duration(seconds: 2),
          ),
        );
      } else if (!include && _gameItems[_gameCurrentIndex]['isCorrect']) {
        ScaffoldMessenger.of(context).showSnackBar(
          const SnackBar(
            content: Text('рдУрд╣реЛ! рдпреЛ рдЖрд╡рд╢реНрдпрдХ рдерд┐рдпреЛред'),
            backgroundColor: Colors.orange,
            duration: Duration(seconds: 2),
          ),
        );
      }
      _gameSelectedItems[_gameCurrentIndex] = include;
      if (_gameCurrentIndex < _gameItems.length - 1) {
        _gameCurrentIndex++;
      } else {
        _gameOver = true;
      }
    });
    Vibration.vibrate(duration: 50);
  }

  void _resetGame() {
    setState(() {
      _gameCurrentIndex = 0;
      _gameCorrectCount = 0;
      _gameOver = false;
      _gameSelectedItems = List.filled(11, false);
      _gameItems.shuffle(Random());
    });
    Vibration.vibrate(duration: 50);
  }

  @override
  void dispose() {
    _audioPlayer.dispose();
    if (_isFlashlightOn) {
      TorchLight.disableTorch();
    }
    super.dispose();
  }

  // Single build method
  @override
  Widget build(BuildContext context) {
    if (_currentScreen == 'quiz') {
      return _buildQuizScreen();
    } else if (_currentScreen == 'game') {
      return WillPopScope(
        onWillPop: () async {
          setState(() {
            _currentScreen = 'home';
            _selectedMenuIndex = 4;
          });
          return false;
        },
        child: _buildGameScreen(),
      );
    } else if (_currentScreen == 'splash') {
      return Scaffold(
        backgroundColor: const Color(0xFF932A31),
        body: Center(
          child: Column(
            mainAxisAlignment: MainAxisAlignment.center,
            children: [
              Image.asset(
                'assets/quakeready_logo.png',
                height: 150,
                width: 150,
              ),
              const SizedBox(height: 20),
              const Text(
                'QuakeReady рдиреЗрдкрд╛рд▓',
                style: TextStyle(
                  fontSize: 24,
                  fontWeight: FontWeight.bold,
                  color: Colors.white,
                ),
              ),
              const SizedBox(height: 40),
              Image.asset(
                'assets/yfgn_logo.png',
                height: 100,
                width: 100,
              ),
              const SizedBox(height: 20),
              const Text(
                'Developed by Youth for Good Nepal',
                style: TextStyle(
                  fontSize: 16,
                  color: Colors.white,
                ),
              ),
            ],
          ),
        ),
      );
    } else if (_currentScreen == 'home') {
      return Scaffold(
        appBar: AppBar(
          title: const Text(
            'QuakeReady рдиреЗрдкрд╛рд▓',
            style: TextStyle(color: Colors.white),
          ),
          backgroundColor: const Color(0xFF932A31),
        ),
        body: Column(
          children: [
            Expanded(
              child: Row(
                children: [
                  Container(
                    width: 150,
                    color: const Color(0xFFE0E0E0),
                    child: Column(
                      children: [
                        _buildMenuItem(0, 'рд╕рд╛рдорд╛рдиреНрдп рдЬрд╛рдирдХрд╛рд░реА'),
                        _buildMenuItem(1, 'рдЖрдкрддрдХрд╛рд▓реАрди рд╕рдореНрдкрд░реНрдХ'),
                        _buildMenuItem(2, 'рдЧрд░реНрдиреБрдкрд░реНрдиреЗ/рдирдЧрд░реНрдиреЗ'),
                        _buildMenuItem(3, 'рд░реЗрдЯреНрд░реЛрдлрд┐рдЯрд┐рдВрдЧ'),
                        _buildMenuItem(4, 'рдЦреЗрд▓рд╣рд░реВ'),
                        _buildMenuItem(5, 'рдХреНрд░реЗрдбрд┐рдЯ'),
                      ],
                    ),
                  ),
                  Expanded(
                    child: _buildContentScreen(),
                  ),
                ],
              ),
            ),
            Padding(
              padding: const EdgeInsets.all(16.0),
              child: Row(
                mainAxisAlignment: MainAxisAlignment.center,
                children: [
                  ElevatedButton(
                    style: ElevatedButton.styleFrom(
                      backgroundColor: _isFlashlightOn ? Colors.grey : Colors.white,
                      padding: const EdgeInsets.all(20),
                      shape: const CircleBorder(),
                    ),
                    onPressed: _toggleFlashlight,
                    child: const Text(
                      'ЁЯФж',
                      style: TextStyle(fontSize: 24),
                    ),
                  ),
                  const SizedBox(width: 40),
                  ElevatedButton(
                    style: ElevatedButton.styleFrom(
                      backgroundColor: _isSirenPlaying ? Colors.grey : Colors.white,
                      padding: const EdgeInsets.all(20),
                      shape: const CircleBorder(),
                    ),
                    onPressed: _toggleSiren,
                    child: const Text(
                      'ЁЯЪи',
                      style: TextStyle(fontSize: 24),
                    ),
                  ),
                ],
              ),
            ),
            Container(
              color: Colors.grey[200],
              padding: const EdgeInsets.all(8.0),
              child: const Text(
                'Developed by Youth for Good Nepal',
                style: TextStyle(fontSize: 14, color: Colors.black),
                textAlign: TextAlign.center,
              ),
            ),
          ],
        ),
      );
    }
    return const SizedBox.shrink();
  }

  Widget _buildMenuItem(int index, String title) {
    return GestureDetector(
      onTap: () {
        setState(() {
          _selectedMenuIndex = index;
          _currentScreen = 'home';
        });
        if (_menuAudioFiles[index].isNotEmpty) {
          _playAudio(_menuAudioFiles[index]);
        }
      },
      child: Container(
        height: 60,
        margin: const EdgeInsets.symmetric(vertical: 4, horizontal: 8),
        decoration: BoxDecoration(
          color: _selectedMenuIndex == index ? Colors.white : Colors.transparent,
          borderRadius: BorderRadius.circular(8),
          border: Border.all(color: Colors.grey, width: 1),
        ),
        child: Center(
          child: Text(
            title,
            style: TextStyle(
              fontSize: 18,
              color: const Color(0xFF932A31),
              fontWeight: _selectedMenuIndex == index ? FontWeight.bold : FontWeight.normal,
            ),
            textAlign: TextAlign.center,
          ),
        ),
      ),
    );
  }

  Widget _buildContentScreen() {
    switch (_selectedMenuIndex) {
      case 0: // Info Screen
        return SingleChildScrollView(
          child: Padding(
            padding: const EdgeInsets.all(16.0),
            child: Column(
              children: [
                Row(
                  mainAxisAlignment: MainAxisAlignment.center,
                  children: [
                    IconButton(
                      onPressed: _toggleInfoAudio,
                      icon: Text(
                        'ЁЯФК',
                        style: TextStyle(
                          fontSize: 24,
                          color: _isInfoAudioPlaying ? Colors.blue : Colors.grey,
                        ),
                      ),
                    ),
                  ],
                ),
                const SizedBox(height: 10),
                Text(
                  _infoContent,
                  style: const TextStyle(fontSize: 16),
                ),
              ],
            ),
          ),
        );

      case 1: // Emergency Contacts Screen
        return ListView.builder(
          padding: const EdgeInsets.all(16.0),
          itemCount: _emergencyContacts.length,
          itemBuilder: (context, index) {
            return ListTile(
              leading: const Icon(Icons.phone, color: Colors.blue),
              title: Text(_emergencyContacts[index]['name']!),
              subtitle: GestureDetector(
                onTap: () => _makePhoneCall(_emergencyContacts[index]['number']!),
                child: Text(
                  _emergencyContacts[index]['number']!,
                  style: const TextStyle(color: Colors.blue, decoration: TextDecoration.underline),
                ),
              ),
            );
          },
        );

      case 2: // Do's and Don'ts Screen
        return SingleChildScrollView(
          child: Padding(
            padding: const EdgeInsets.all(16.0),
            child: Column(
              crossAxisAlignment: CrossAxisAlignment.start,
              children: [
                Row(
                  mainAxisAlignment: MainAxisAlignment.center,
                  children: [
                    IconButton(
                      onPressed: _toggleDosDontsAudio,
                      icon: Text(
                        'ЁЯФК',
                        style: TextStyle(
                          fontSize: 24,
                          color: _isDosDontsAudioPlaying ? Colors.blue : Colors.grey,
                        ),
                      ),
                    ),
                  ],
                ),
                const SizedBox(height: 10),
                const Text(
                  'тЬЕ рдЧрд░реНрдиреБрдкрд░реНрдиреЗ рдХреБрд░рд╛рд╣рд░реВ:',
                  style: TextStyle(fontSize: 18, fontWeight: FontWeight.bold),
                ),
                const SizedBox(height: 8),
                ..._dos.map((e) => ListTile(
                  leading: const Icon(Icons.check, color: Colors.green),
                  title: Text(e),
                )),
                const SizedBox(height: 16),
                const Text(
                  'тЭМ рдирдЧрд░реНрдиреБрдкрд░реНрдиреЗ рдХреБрд░рд╛рд╣рд░реВ:',
                  style: TextStyle(fontSize: 18, fontWeight: FontWeight.bold),
                ),
                const SizedBox(height: 8),
                ..._donts.map((e) => ListTile(
                  leading: const Icon(Icons.close, color: Colors.red),
                  title: Text(e),
                )),
              ],
            ),
          ),
        );

      case 3: // Retrofitting Screen
        return SingleChildScrollView(
          child: Padding(
            padding: const EdgeInsets.all(16.0),
            child: Column(
              children: [
                Row(
                  mainAxisAlignment: MainAxisAlignment.center,
                  children: [
                    IconButton(
                      onPressed: _toggleRetrofittingAudio,
                      icon: Text(
                        'ЁЯФК',
                        style: TextStyle(
                          fontSize: 24,
                          color: _isRetrofittingAudioPlaying ? Colors.blue : Colors.grey,
                        ),
                      ),
                    ),
                  ],
                ),
                const SizedBox(height: 10),
                Text(
                  _retrofittingContent,
                  style: const TextStyle(fontSize: 16),
                ),
              ],
            ),
          ),
        );

      case 4: // Games Selection Screen
        return Center(
          child: Column(
            mainAxisAlignment: MainAxisAlignment.center,
            children: [
              const Text(
                'рдЦреЗрд▓рд╣рд░реВ рдЫрд╛рдиреНрдиреБрд╣реЛрд╕реН',
                style: TextStyle(fontSize: 24, fontWeight: FontWeight.bold),
              ),
              const SizedBox(height: 40),
              ElevatedButton(
                style: ElevatedButton.styleFrom(
                  backgroundColor: Colors.teal,
                  padding: const EdgeInsets.symmetric(horizontal: 40, vertical: 20),
                ),
                onPressed: () {
                  setState(() {
                    _currentScreen = 'quiz';
                  });
                  Vibration.vibrate(duration: 50);
                },
                child: const Text(
                  'рдХреНрд╡рд┐рдЬ',
                  style: TextStyle(fontSize: 18, color: Colors.white),
                ),
              ),
              const SizedBox(height: 20),
              ElevatedButton(
                style: ElevatedButton.styleFrom(
                  backgroundColor: Colors.teal,
                  padding: const EdgeInsets.symmetric(horizontal: 40, vertical: 20),
                ),
                onPressed: () {
                  setState(() {
                    _currentScreen = 'game';
                  });
                  Vibration.vibrate(duration: 50);
                },
                child: const Text(
                  'рдЖрдкрддрдХрд╛рд▓реАрди рдХрд┐рдЯ рдЦреЗрд▓',
                  style: TextStyle(fontSize: 18, color: Colors.white),
                ),
              ),
            ],
          ),
        );

      case 5: // Credits Screen
        return SingleChildScrollView(
          child: Padding(
            padding: const EdgeInsets.all(16.0),
            child: Column(
              crossAxisAlignment: CrossAxisAlignment.center,
              children: [
                const Text(
                  'рдХреНрд░реЗрдбрд┐рдЯ',
                  style: TextStyle(fontSize: 24, fontWeight: FontWeight.bold),
                ),
                const SizedBox(height: 20),
                const Text(
                  'рдбреЗрднрд▓рдкрд░:',
                  style: TextStyle(fontSize: 18, fontWeight: FontWeight.bold),
                ),
                const Text(
                  'рдкреНрд░рдореЗрд╢ рднрдЯреНрдЯрд░рд╛рдИ',
                  style: TextStyle(fontSize: 16),
                ),
                const SizedBox(height: 20),
                const Text(
                  'рдЖрдЗрдбрд┐рдпрд╛ рд░ рдЗрдирдкреБрдЯ:',
                  style: TextStyle(fontSize: 18, fontWeight: FontWeight.bold),
                ),
                const Text(
                  'рдЕрдорди рдХреЛрдЗрд░рд╛рд▓рд╛\nрдЕрдЮреНрдЬрд┐рд▓рд╛ рднрдЯреНрдЯрд░рд╛рдИ\nрд╕реЗрд╕рди рдкреМрдбреЗрд▓\nрд╢реНрд░реА рдХреГрд╖реНрдг рдврдХрд╛рд▓\nрдорд┐рд▓рди рдХреЛрдЗрд░рд╛рд▓рд╛',
                  style: TextStyle(fontSize: 16),
                  textAlign: TextAlign.center,
                ),
              ],
            ),
          ),
        );

      default:
        return const SizedBox.shrink();
    }
  }

  Widget _buildQuizScreen() {
    double safetyScore = _quizCorrectAnswers / 10;
    return Scaffold(
      appBar: AppBar(
        title: const Text('рдХреНрд╡рд┐рдЬ'),
        backgroundColor: Colors.teal,
      ),
      body: _quizShowResults
          ? Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            Text(
              'рддрдкрд╛рдИрдВрдХреЛ рд╕реНрдХреЛрд░: $_quizCorrectAnswers/10',
              style: const TextStyle(fontSize: 24, fontWeight: FontWeight.bold),
            ),
            const SizedBox(height: 16),
            ElevatedButton(
              onPressed: () {
                _resetQuiz();
                setState(() {
                  _currentScreen = 'quiz';
                });
              },
              child: const Text('рдлреЗрд░рд┐ рдЦреЗрд▓реНрдиреБрд╣реЛрд╕реН'),
            ),
            const SizedBox(height: 16),
            ElevatedButton(
              onPressed: () {
                setState(() {
                  _currentScreen = 'home';
                  _selectedMenuIndex = 4;
                });
              },
              child: const Text('рдлрд░реНрдХрдиреБрд╣реЛрд╕реН'),
            ),
          ],
        ),
      )
          : Padding(
        padding: const EdgeInsets.all(16.0),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            LinearProgressIndicator(
              value: safetyScore,
              backgroundColor: Colors.red,
              valueColor: const AlwaysStoppedAnimation<Color>(Colors.green),
              minHeight: 10,
            ),
            const SizedBox(height: 16),
            Text(
              'рдкреНрд░рд╢реНрди ${_quizCurrentQuestionIndex + 1}/10',
              style: const TextStyle(fontSize: 18, fontWeight: FontWeight.bold),
            ),
            const SizedBox(height: 8),
            Text(
              _quizSelectedQuestions[_quizCurrentQuestionIndex]['question'],
              style: const TextStyle(fontSize: 16),
            ),
            const SizedBox(height: 16),
            ...List.generate(
              _quizSelectedQuestions[_quizCurrentQuestionIndex]['options'].length,
                  (index) => Padding(
                padding: const EdgeInsets.symmetric(vertical: 4.0),
                child: ElevatedButton(
                  style: ElevatedButton.styleFrom(
                    backgroundColor: _quizUserAnswers[_quizCurrentQuestionIndex] == null
                        ? Colors.blue
                        : index == _quizSelectedQuestions[_quizCurrentQuestionIndex]['correct']
                        ? Colors.green
                        : _quizUserAnswers[_quizCurrentQuestionIndex] == index
                        ? Colors.red
                        : Colors.blue,
                  ),
                  onPressed: _quizUserAnswers[_quizCurrentQuestionIndex] == null
                      ? () {
                    _answerQuestion(index);
                    Vibration.vibrate(duration: 50);
                  }
                      : null,
                  child: Text(
                    _quizSelectedQuestions[_quizCurrentQuestionIndex]['options'][index],
                    style: const TextStyle(color: Colors.white),
                  ),
                ),
              ),
            ),
          ],
        ),
      ),
    );
  }

  Widget _buildGameScreen() {
    return Scaffold(
      appBar: AppBar(
        title: const Text('рдЖрдкрддрдХрд╛рд▓реАрди рдХрд┐рдЯ рдЦреЗрд▓'),
        backgroundColor: Colors.teal,
        leading: IconButton(
          icon: const Icon(Icons.arrow_back),
          onPressed: () {
            setState(() {
              _currentScreen = 'home';
              _selectedMenuIndex = 4;
            });
          },
        ),
      ),
      body: Container(
        decoration: const BoxDecoration(
          gradient: LinearGradient(
            colors: [Colors.yellow, Colors.green],
            begin: Alignment.topLeft,
            end: Alignment.bottomRight,
          ),
        ),
        child: Center(
          child: _gameOver
              ? Column(
            mainAxisAlignment: MainAxisAlignment.center,
            children: [
              Text(
                'рдЦреЗрд▓ рд╕рдорд╛рдкреНрдд! рд╕реНрдХреЛрд░: $_gameCorrectCount/7',
                style: const TextStyle(fontSize: 24, color: Colors.white, fontWeight: FontWeight.bold),
                textAlign: TextAlign.center,
              ),
              const SizedBox(height: 20),
              ElevatedButton(
                style: ElevatedButton.styleFrom(
                  backgroundColor: Colors.purple,
                  padding: const EdgeInsets.symmetric(horizontal: 20, vertical: 10),
                ),
                onPressed: () {
                  _resetGame();
                  setState(() {
                    _currentScreen = 'game';
                  });
                },
                child: const Text(
                  'рдлреЗрд░рд┐ рдЦреЗрд▓реНрдиреБрд╣реЛрд╕реН',
                  style: TextStyle(color: Colors.white, fontSize: 16),
                ),
              ),
              const SizedBox(height: 16),
              ElevatedButton(
                onPressed: () {
                  setState(() {
                    _currentScreen = 'home';
                    _selectedMenuIndex = 4;
                  });
                },
                child: const Text('рдлрд░реНрдХрдиреБрд╣реЛрд╕реН'),
              ),
            ],
          )
              : Column(
            mainAxisAlignment: MainAxisAlignment.center,
            children: [
              Text(
                _gameItems[_gameCurrentIndex]['name'],
                style: const TextStyle(fontSize: 32, color: Colors.white, fontWeight: FontWeight.bold),
              ),
              const SizedBox(height: 40),
              Row(
                mainAxisAlignment: MainAxisAlignment.center,
                children: [
                  ElevatedButton(
                    style: ElevatedButton.styleFrom(
                      backgroundColor: Colors.blue,
                      padding: const EdgeInsets.symmetric(horizontal: 20, vertical: 15),
                    ),
                    onPressed: () => _selectGameItem(true),
                    child: const Text(
                      'рд░рд╛рдЦреНрдиреБрд╣реЛрд╕реН',
                      style: TextStyle(color: Colors.white, fontSize: 18),
                    ),
                  ),
                  const SizedBox(width: 20),
                  ElevatedButton(
                    style: ElevatedButton.styleFrom(
                      backgroundColor: Colors.red,
                      padding: const EdgeInsets.symmetric(horizontal: 20, vertical: 15),
                    ),
                    onPressed: () => _selectGameItem(false),
                    child: const Text(
                      'рд╣рдЯрд╛рдЙрдиреБрд╣реЛрд╕реН',
                      style: TextStyle(color: Colors.white, fontSize: 18),
                    ),
                  ),
                ],
              ),
            ],
          ),
        ),
      ),
    );
  }
}